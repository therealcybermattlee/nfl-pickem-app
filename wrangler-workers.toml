name = "nfl-pickem-app-api"
compatibility_date = "2024-09-04"
compatibility_flags = ["nodejs_compat"]

# Main worker script
main = "src/worker.ts"

# D1 database binding
[[d1_databases]]
binding = "DB"
database_name = "nfl-pickem-db"
database_id = "b85129d8-b27c-4c73-bd34-5314a881394b"

# Environment variables
[vars]
NODE_ENV = "development"

# Production environment
[env.production]
name = "nfl-pickem-app-production"

[env.production.vars]
NODE_ENV = "production"
NEXTAUTH_URL = "https://nfl-pickem-app-production.cybermattlee-llc.workers.dev"
THE_ODDS_API_BASE_URL = "https://api.the-odds-api.com/v4"
CURRENT_NFL_SEASON = "2025"
CURRENT_NFL_WEEK = "1"

# D1 database binding for production
[[env.production.d1_databases]]
binding = "DB"
database_name = "nfl-pickem-db"
database_id = "b85129d8-b27c-4c73-bd34-5314a881394b"

# Cron trigger for automated score updates
# Runs every 15 minutes during game days (Thu-Mon, Sept-Feb)
[triggers]
crons = ["*/15 * * * *"]

# Secrets to be set via wrangler secret put
# THE_ODDS_API_KEY
# NEXTAUTH_SECRET