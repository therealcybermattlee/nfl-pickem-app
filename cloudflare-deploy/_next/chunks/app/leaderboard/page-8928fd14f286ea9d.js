(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{534:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},814:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},3568:(e,s,t)=>{Promise.resolve().then(t.bind(t,5888))},5888:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(5155),r=t(2115),c=t(6489),d=t(63),l=t(6257),i=t(3209),n=t(3884),o=t(7812),x=t(6613),m=t(1847);let h=(0,m.A)("medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),u=(0,m.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var j=t(814);function f(e){let{leaderboard:s,type:t,week:r,season:c}=e;return 0===s.length?(0,a.jsx)(i.Zp,{children:(0,a.jsx)(i.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsxs)("p",{children:["No picks found for this ","week"===t?"week":"season","."]}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Users will appear here once they start making picks."})]})})}):(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsxs)(i.ZB,{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"week"===t?"Week ".concat(r):"".concat(c," Season")," Leaderboard"]}),(0,a.jsx)(i.BT,{children:"week"===t?"Weekly standings for Week ".concat(r,", ").concat(c):"Overall season standings for ".concat(c)})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"space-y-4",children:s.map((e,s)=>{var t;let r=s+1,c=r<=3;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border ".concat(c?"bg-gradient-to-r from-muted/50 to-background":"bg-background"," ").concat(1===r?"border-yellow-200 shadow-sm":""),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8",children:(e=>{switch(e){case 1:return(0,a.jsx)(x.A,{className:"h-5 w-5 text-yellow-500"});case 2:return(0,a.jsx)(h,{className:"h-5 w-5 text-gray-400"});case 3:return(0,a.jsx)(u,{className:"h-5 w-5 text-amber-600"});default:return(0,a.jsxs)("span",{className:"text-lg font-bold text-muted-foreground",children:["#",e]})}})(r)}),(0,a.jsxs)(n.eu,{className:"h-10 w-10",children:[(0,a.jsx)(n.BK,{src:""}),(0,a.jsx)(n.q5,{children:(t=e.name)?t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium flex items-center space-x-2",children:[(0,a.jsx)("span",{children:e.name||e.username||"Unknown User"}),c&&(e=>{switch(e){case 1:return(0,a.jsx)(o.E,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"1st"});case 2:return(0,a.jsx)(o.E,{className:"bg-gray-100 text-gray-800 border-gray-200",children:"2nd"});case 3:return(0,a.jsx)(o.E,{className:"bg-amber-100 text-amber-800 border-amber-200",children:"3rd"});default:return(0,a.jsxs)(o.E,{variant:"outline",children:["#",e]})}})(r)]}),e.username&&e.name&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["@",e.username]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-right",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Points"}),(0,a.jsx)("div",{className:"text-lg font-bold text-blue-600",children:e.points})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Correct"}),(0,a.jsxs)("div",{className:"text-lg font-bold text-green-600",children:[e.correctPicks,"/",e.totalPicks]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Accuracy"}),(0,a.jsxs)("div",{className:"text-lg font-bold",children:[e.accuracy.toFixed(1),"%"]})]})]})]},e.userId)})}),(0,a.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Participants"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Math.max(...s.map(e=>e.totalPicks))}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Most Picks"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:Math.max(...s.map(e=>e.correctPicks))}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Most Correct"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[Math.max(...s.map(e=>e.accuracy)).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Best Accuracy"})]})]})})]})]})}var v=t(7003),p=t(9559),y=t(534),N=t(6485);function g(){let{data:e,status:s}=(0,c.useSession)(),t=(0,d.useRouter)(),[n,o]=(0,r.useState)([]),[m,h]=(0,r.useState)("week"),[u,j]=(0,r.useState)(1),[g,b]=(0,r.useState)(new Date().getFullYear()),[k,w]=(0,r.useState)(!0),[A,M]=(0,r.useState)(null);(0,r.useEffect)(()=>{if("loading"!==s){if(!e)return void t.push("/signin");P()}},[e,s,t,m]);let P=async()=>{try{w(!0),M(null);let e=new URLSearchParams({type:m}),s=await fetch("/api/leaderboard?".concat(e.toString())),t=await s.json();if(!t.success)throw Error(t.error||"Failed to fetch leaderboard");o(t.leaderboard),j(t.week||1),b(t.season)}catch(e){M(e instanceof Error?e.message:"An error occurred")}finally{w(!1)}},S=async()=>{try{w(!0);let e=await fetch("/api/leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"recalculate",season:g})}),s=await e.json();if(!s.success)throw Error(s.error||"Failed to recalculate scores");await P()}catch(e){M(e instanceof Error?e.message:"Recalculation failed"),w(!1)}};if("loading"===s||k)return(0,a.jsx)(l.O,{children:(0,a.jsx)("div",{className:"flex min-h-[50vh] items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:"Loading leaderboard..."})})});if(!e)return null;if(A)return(0,a.jsx)(l.O,{children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)(i.Zp,{children:(0,a.jsxs)(i.Wu,{className:"p-6",children:[(0,a.jsx)("div",{className:"text-center text-destructive mb-4",children:A}),(0,a.jsxs)(v.$,{onClick:P,variant:"outline",size:"sm",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})})});let C=n.findIndex(s=>s.userId===e.user.id)+1,E=n.find(s=>s.userId===e.user.id);return(0,a.jsx)(l.O,{children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center",children:[(0,a.jsx)(x.A,{className:"h-8 w-8 mr-2"}),"Leaderboard"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"See how you rank against other players"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(v.$,{onClick:P,variant:"outline",size:"sm",disabled:k,children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2 ".concat(k?"animate-spin":"")}),"Refresh"]}),e.user.isAdmin&&(0,a.jsxs)(v.$,{onClick:S,variant:"outline",size:"sm",disabled:k,children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Recalculate"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(v.$,{variant:"week"===m?"default":"outline",size:"sm",onClick:()=>h("week"),children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Weekly"]}),(0,a.jsxs)(v.$,{variant:"season"===m?"default":"outline",size:"sm",onClick:()=>h("season"),children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Season"]})]}),E&&(0,a.jsx)(i.Zp,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:(0,a.jsx)(i.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-full",children:(0,a.jsxs)("span",{className:"text-lg font-bold text-blue-600",children:["#",C]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Your Position"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["week"===m?"Week ".concat(u):"".concat(g," Season")," standings"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-blue-600",children:E.points}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Points"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-lg font-bold text-green-600",children:[E.correctPicks,"/",E.totalPicks]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Correct"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-lg font-bold",children:[E.accuracy.toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Accuracy"})]})]})]})})}),(0,a.jsx)(f,{leaderboard:n,type:m,week:"week"===m?u:void 0,season:g}),"season"===m&&n.length>0&&(0,a.jsx)(i.Zp,{children:(0,a.jsxs)(i.Wu,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Season Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:n.reduce((e,s)=>e+s.totalPicks,0)}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Picks"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:n.reduce((e,s)=>e+s.correctPicks,0)}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Correct Picks"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[(n.reduce((e,s)=>e+s.accuracy,0)/n.length).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Average Accuracy"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:n.reduce((e,s)=>e+s.points,0)}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Points"})]})]})]})})]})})})}},6485:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},6613:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},7812:(e,s,t)=>{"use strict";t.d(s,{E:()=>l});var a=t(5155);t(2115);var r=t(3101),c=t(5016);let d=(0,r.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)(d({variant:t}),s),...r})}},9559:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[489,690,360,545,441,493,358],()=>e(e.s=3568)),_N_E=e.O()}]);