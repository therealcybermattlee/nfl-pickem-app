(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{814:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(1847).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},1921:(e,s,r)=>{Promise.resolve().then(r.bind(r,4766))},4766:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>b});var a=r(5155),t=r(2115),i=r(6489),d=r(63),n=r(6257),l=r(3209),c=r(7003),o=r(3884),m=r(7812),x=r(1847);let h=(0,x.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var u=r(5229);let p=(0,x.A)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var j=r(6485),f=r(814),v=r(6613),g=r(508),y=r(8720),N=r(4662);function b(){let{data:e,status:s,update:r}=(0,i.useSession)(),x=(0,d.useRouter)(),[b,k]=(0,t.useState)(null),[w,M]=(0,t.useState)(!0),[A,C]=(0,t.useState)(!1),[E,P]=(0,t.useState)(!1),[S,T]=(0,t.useState)(null),[R,Z]=(0,t.useState)(""),[W,H]=(0,t.useState)("");(0,t.useEffect)(()=>{if("loading"!==s){if(!e)return void x.push("/signin");I()}},[e,s,x]);let I=async()=>{try{M(!0),T(null);let e=await fetch("/api/user/profile"),s=await e.json();if(!s.success)throw Error(s.error||"Failed to fetch profile");k(s.user),Z(s.user.name||""),H(s.user.username||"")}catch(e){T(e instanceof Error?e.message:"An error occurred")}finally{M(!1)}},F=async()=>{if(!R.trim())return void y.oR.error("Name is required");P(!0);try{let e=await fetch("/api/user/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:R.trim(),username:W.trim()||null})}),s=await e.json();if(!s.success)throw Error(s.error||"Failed to update profile");k(e=>e?{...e,...s.user}:null),C(!1),await r({name:s.user.name,username:s.user.username}),y.oR.success("Profile updated successfully!")}catch(e){y.oR.error(e instanceof Error?e.message:"Failed to update profile")}finally{P(!1)}};if("loading"===s||w)return(0,a.jsx)(n.O,{children:(0,a.jsx)("div",{className:"flex min-h-[50vh] items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:"Loading..."})})});if(!e||!b)return null;let _=b.picks.filter(e=>e.game.isCompleted&&e.game.winnerTeamId===e.teamId).length,B=b.picks.filter(e=>e.game.isCompleted).length,O=B>0?Math.round(_/B*100):0;return(0,a.jsx)(n.O,{children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(o.eu,{className:"h-16 w-16",children:[(0,a.jsx)(o.BK,{src:b.image||""}),(0,a.jsx)(o.q5,{className:"text-lg",children:b.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})]}),(0,a.jsxs)("div",{children:[A?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"text",value:R,onChange:e=>Z(e.target.value),className:"text-2xl font-bold bg-background border border-input rounded px-2 py-1",placeholder:"Your name"}),(0,a.jsx)("input",{type:"text",value:W,onChange:e=>H(e.target.value),className:"text-sm bg-background border border-input rounded px-2 py-1",placeholder:"Username (optional)"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:b.name}),b.username&&(0,a.jsxs)("p",{className:"text-muted-foreground",children:["@",b.username]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:b.email}),b.isAdmin&&(0,a.jsx)(m.E,{variant:"secondary",className:"mt-1",children:"Administrator"})]})]}),(0,a.jsx)("div",{className:"flex space-x-2",children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.$,{onClick:F,disabled:E,children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2"}),"Save"]}),(0,a.jsxs)(c.$,{variant:"outline",onClick:()=>{C(!1),Z((null==b?void 0:b.name)||""),H((null==b?void 0:b.username)||"")},disabled:E,children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):(0,a.jsxs)(c.$,{variant:"outline",onClick:()=>C(!0),children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Member since ",(0,N.GP)(new Date(b.createdAt),"MMMM d, yyyy")]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(l.Zp,{children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:b.picks.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Picks"})]})]})})}),(0,a.jsx)(l.Zp,{children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:_}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Correct Picks"})]})]})})}),(0,a.jsx)(l.Zp,{children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[O,"%"]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Win Rate"})]})]})})}),(0,a.jsx)(l.Zp,{children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:b.poolMemberships.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Pools Joined"})]})})})]}),b.picks.length>0&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Recent Picks"}),(0,a.jsxs)(l.BT,{children:["Your last ",Math.min(b.picks.length,10)," picks"]})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:b.picks.slice(0,10).map(e=>{let s=e.game.isCompleted&&e.game.winnerTeamId===e.teamId;return e.game.isCompleted&&(e.game.winnerTeamId,e.teamId),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.game.awayTeam.abbreviation," @ ",e.game.homeTeam.abbreviation]}),(0,a.jsx)("div",{className:"text-muted-foreground",children:(0,N.GP)(new Date(e.game.gameDate),"MMM d, h:mm a")})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:["Picked: ",e.team.abbreviation]}),e.game.isCompleted&&(0,a.jsx)(m.E,{variant:s?"default":"destructive",className:s?"bg-green-100 text-green-800":"",children:s?"Correct":"Incorrect"})]})]},e.id)})})})]}),b.poolMemberships.length>0&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"My Pools"}),(0,a.jsx)(l.BT,{children:"Competition pools you've joined"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:b.poolMemberships.map(e=>{let{pool:s}=e;return(0,a.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,a.jsx)("div",{className:"font-medium",children:s.name}),s.description&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:s.description})]},s.id)})})})]})]})})})}},5229:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6485:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},6613:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(1847).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},7812:(e,s,r)=>{"use strict";r.d(s,{E:()=>n});var a=r(5155);r(2115);var t=r(3101),i=r(5016);let d=(0,t.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:r,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)(d({variant:r}),s),...t})}}},e=>{e.O(0,[489,690,360,662,720,545,441,493,358],()=>e(e.s=1921)),_N_E=e.O()}]);