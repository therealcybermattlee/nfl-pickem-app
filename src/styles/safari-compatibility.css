/* Safari Cross-Browser Compatibility Styles */
/* Addresses Safari-specific text rendering and color issues */

/* Safari Detection and Base Fixes */
@supports (-webkit-appearance: none) {
  /* Force hardware acceleration for smoother rendering */
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }
  
  /* Fix Safari's handling of CSS custom properties */
  html {
    color-scheme: light dark;
  }
  
  /* Ensure proper color inheritance in Safari */
  body, body * {
    color: inherit;
  }
}

/* Safari-specific media queries for WebKit engine */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Light mode specific fixes */
  @media (prefers-color-scheme: light) {
    :root {
      --safari-foreground: rgb(0, 0, 0);
      --safari-background: rgb(255, 255, 255);
      --safari-muted: rgb(60, 60, 60);
      --safari-border: rgb(229, 231, 235);
    }
  }
  
  /* Dark mode specific fixes */
  @media (prefers-color-scheme: dark) {
    :root {
      --safari-foreground: rgb(250, 250, 250);
      --safari-background: rgb(15, 15, 15);
      --safari-muted: rgb(161, 161, 170);
      --safari-border: rgb(39, 39, 42);
    }
  }
  
  /* Force Safari to use the correct colors */
  body {
    color: var(--safari-foreground) !important;
    background-color: var(--safari-background) !important;
  }
  
  /* Fix common elements that Safari renders incorrectly */
  h1, h2, h3, h4, h5, h6 {
    color: var(--safari-foreground);
  }
  
  p, span, div, li {
    color: inherit;
  }
  
  /* Fix button and form element colors */
  button, input, textarea, select {
    color: var(--safari-foreground);
  }
  
  /* Fix link colors */
  a {
    color: inherit;
  }
  
  a:hover {
    opacity: 0.8;
  }
}

/* Safari-specific fixes for common UI patterns */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Card components */
  .bg-white, .bg-gray-50 {
    background-color: var(--safari-background) !important;
    color: var(--safari-foreground) !important;
  }
  
  /* Muted text elements */
  .text-gray-500, .text-gray-600, .text-muted-foreground {
    color: var(--safari-muted) !important;
  }
  
  /* Border elements */
  .border, .border-gray-200, .border-gray-300 {
    border-color: var(--safari-border) !important;
  }
  
  /* Loading states */
  .animate-pulse {
    background-color: var(--safari-muted) !important;
    opacity: 0.5;
  }
  
  /* Shadow elements - Safari handles shadows differently */
  .shadow-sm, .shadow, .shadow-md, .shadow-lg {
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important;
  }
}

/* Safari-specific dark mode enhancements */
@media screen and (-webkit-min-device-pixel-ratio: 0) and (prefers-color-scheme: dark) {
  /* Ensure dark backgrounds are truly dark */
  .bg-gray-800, .bg-gray-900 {
    background-color: rgb(15, 15, 15) !important;
    color: rgb(250, 250, 250) !important;
  }
  
  /* Fix dark mode borders */
  .border-gray-700, .border-gray-800 {
    border-color: rgb(39, 39, 42) !important;
  }
  
  /* Dark mode text colors */
  .text-white {
    color: rgb(250, 250, 250) !important;
  }
  
  /* Dark mode muted text */
  .text-gray-300, .text-gray-400 {
    color: rgb(161, 161, 170) !important;
  }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  /* Fix viewport units on iOS Safari */
  .min-h-screen {
    min-height: -webkit-fill-available;
  }
  
  /* Fix input zoom on iOS Safari */
  input[type="text"], input[type="email"], input[type="password"], textarea, select {
    font-size: 16px !important;
  }
  
  /* Fix sticky positioning */
  .sticky {
    position: -webkit-sticky;
    position: sticky;
  }
  
  /* Prevent iOS Safari from adding tap highlights */
  button, a, [role="button"] {
    -webkit-tap-highlight-color: transparent;
  }
}

/* Safari performance optimizations */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Force GPU acceleration for animations */
  .transition-all, .transition-colors, .transition-opacity, .transition-transform {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
  
  /* Optimize scrolling performance */
  .overflow-auto, .overflow-y-auto, .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
  }
  
  /* Fix Safari's handling of flexbox */
  .flex {
    display: -webkit-flex;
    display: flex;
  }
  
  .flex-col {
    -webkit-flex-direction: column;
    flex-direction: column;
  }
  
  .items-center {
    -webkit-align-items: center;
    align-items: center;
  }
  
  .justify-center {
    -webkit-justify-content: center;
    justify-content: center;
  }
}

/* Safari accessibility improvements */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Improve focus indicators for Safari */
  *:focus {
    outline: 2px solid #3B82F6;
    outline-offset: 2px;
  }
  
  /* Remove default Safari focus styling */
  *:focus:not(:focus-visible) {
    outline: none;
  }
  
  /* Ensure focus is visible for keyboard navigation */
  *:focus-visible {
    outline: 2px solid #3B82F6;
    outline-offset: 2px;
  }
}

/* High DPI display fixes for Safari */
@media screen and (-webkit-min-device-pixel-ratio: 2) {
  /* Ensure crisp rendering on Retina displays */
  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* Fix icon and image rendering */
  img, svg {
    -webkit-font-smoothing: antialiased;
  }
}

/* Safari mobile landscape fixes */
@media screen and (-webkit-min-device-pixel-ratio: 0) and (orientation: landscape) and (max-height: 500px) {
  /* Fix viewport height issues in mobile Safari landscape */
  .min-h-screen {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  /* Adjust spacing for landscape mode */
  .py-8 {
    padding-top: 1rem !important;
    padding-bottom: 1rem !important;
  }
}

/* Safari contrast and readability improvements */
@media screen and (-webkit-min-device-pixel-ratio: 0) and (prefers-contrast: high) {
  /* Increase contrast for high contrast mode */
  body {
    color: rgb(0, 0, 0) !important;
    background-color: rgb(255, 255, 255) !important;
  }
  
  @media (prefers-color-scheme: dark) {
    body {
      color: rgb(255, 255, 255) !important;
      background-color: rgb(0, 0, 0) !important;
    }
  }
  
  /* Ensure all interactive elements have strong borders */
  button, input, select, textarea, a {
    border: 2px solid currentColor !important;
  }
}